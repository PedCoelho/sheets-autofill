(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{236:function(e,t,n){var content=n(265);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("1b7833da",content,!0,{sourceMap:!1})},264:function(e,t,n){"use strict";n(236)},265:function(e,t,n){var o=n(84)(!1);o.push([e.i,".feedback-text{color:red;margin-bottom:1rem}.feedback-text-positive{color:green;margin-bottom:1rem}#image{display:flex;flex-flow:column;justify-content:center;align-items:center}#image canvas{margin-bottom:1rem}.column{padding:unset}",""]),e.exports=o},268:function(e,t,n){"use strict";n.r(t);var o=n(7),r=n(112),c=n(16),l=n(111);var d=n(153),m=n(78);function h(e){return function(e){if(Array.isArray(e))return Object(l.a)(e)}(e)||Object(d.a)(e)||Object(m.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n(50),n(14),n(29),n(38),n(238),n(23),n(242),n(244),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(28),n(176),n(62),n(63),n(42),n(260),n(34),n(64),n(89),n(33),n(261),n(88),n(122),n(263);var f={data:function(){return{feedback:"",positive_feedback:"",stepItems:[{name:"Model",done:!1,type:"autocomplete",model:void 0},{name:"Category",done:!1,type:"autocomplete",model:void 0},{name:"Sub-category",done:!1,type:"autocomplete",model:void 0},{name:"Difficulty",done:!1,type:"number",model:void 0},{name:"Enjoyment",done:!1,type:"number",model:void 0},{name:"Author",done:!1,type:"autocomplete",model:void 0},{name:"Found in",done:!1,type:"autocomplete",model:void 0},{name:"Date",done:!1,type:"datetime-local",model:void 0},{name:"Picture",done:!1,type:"file",model:void 0},{name:"Notes",done:!1,type:"text",model:void 0}],GoogleAuth:void 0,isAuthorized:void 0,currentApiRequest:void 0,activeStep:0,spreadSheetData:void 0,showSocial:!1,isAnimated:!0,isRounded:!0,isStepsClickable:!1,hasNavigation:!0,customNavigation:!1,prevIcon:"chevron-left",nextIcon:"chevron-right",labelPosition:"bottom",mobileMode:"minimalist"}},computed:{modelData:function(){return{name:this.stepItems[0].model,cat:this.stepItems[1].model,subcat:this.stepItems[2].model,challenge:this.stepItems[3].model,pleasure:this.stepItems[4].model,author:this.stepItems[5].model,found:this.stepItems[6].model,date:this.stepItems[7].model,picture:this.stepItems[8].model,note:this.stepItems[9].model}},authorSelected:function(){return this.modelData.author},booksWithAuthors:function(){var e,t=null===(e=this.spreadSheetData)||void 0===e?void 0:e.values;if(t){var n={authors:t[5].slice(1),books:t[6].slice(1)};return n.books.reduce((function(a,e,i){return""==n.authors[i]||(a[e]?a[e].push(n.authors[i]):a[e]=[n.authors[i]],a[e]=h(new Set(a[e]))),a}),{})}return[]},foundInAutocomplete:function(){var e=this,t=[];return Object.entries(this.booksWithAuthors).forEach((function(n){var o=Object(c.a)(n,2),r=o[0];o[1].some((function(t){var n;return null==t?void 0:t.toUpperCase().includes(null===(n=e.authorSelected)||void 0===n?void 0:n.toUpperCase())}))&&t.push(r)})),t},autoCompleteData:function(){var e,t=null===(e=this.spreadSheetData)||void 0===e?void 0:e.values;return t?((t=t.map((function(e){var t=Object(r.a)(e),n=(t[0],t.slice(1));return h(new Set(n)).filter((function(e){return Boolean(e.length)})).sort((function(a,b){return a.localeCompare(b)}))})))[6]=this.foundInAutocomplete,t):[]}},watch:{isAuthorized:function(e){e&&this.sendAuthorizedApiRequest()}},mounted:function(){this.authSetup();var e=new Date;this.stepItems[7].model=e.toISOString().substr(0,10)+"T"+e.toLocaleTimeString()},methods:{checkStep:function(){var e=this,t=this.stepItems[this.activeStep];t.done||(t.done=!0,setTimeout((function(){e.activeStep++}),400))},authSetup:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$gapi.getGapiClient();case 3:return n=t.sent,t.next=6,n.auth2.getAuthInstance();case 6:if(o=t.sent,e.GoogleAuth=o,e.isAuthorized=o.isSignedIn.get(),e.isAuthorized){t.next=14;break}return e.positive_feedback="Attempting Google oAuth2.0",t.next=13,e.loginAttempt(o);case 13:e.isAuthorized=t.sent;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),e.positive_feedback="",e.feedback=t.t0.error.message;case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))()},loginAttempt:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.positive_feedback="Attempting login",n.prev=1,n.next=4,e.signIn();case 4:if(o=n.sent){n.next=7;break}return n.abrupt("return",!1);case 7:return r=o.isSignedIn(),n.abrupt("return",r);case 11:return n.prev=11,n.t0=n.catch(1),console.error(n.t0),n.abrupt("return",!1);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))()},sendAuthorizedApiRequest:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e,"16uuM7tnvUeUNTM63sQD1NNZGMUUSRI2lVPQFG5oxdC8",!e.isAuthorized){t.next=7;break}o={spreadsheetId:"16uuM7tnvUeUNTM63sQD1NNZGMUUSRI2lVPQFG5oxdC8",range:"Main",majorDimension:"COLUMNS"},e.$gapi.getGapiClient().then((function(e){console.log(e),e.client.sheets.spreadsheets.values.get(o).then((function(e){n.spreadSheetData=e.result,console.log(n.spreadSheetData)}))})),t.next=12;break;case 7:if(!e.GoogleAuth){t.next=12;break}return t.next=10,e.loginAttempt(e.GoogleAuth);case 10:t.sent?e.sendAuthorizedApiRequest():alert("User needs to be signed in before making request to Google Sheets API");case 12:case"end":return t.stop()}}),t)})))()},filterOptions:function(e,t){if(t)return t.filter((function(option){return!!option&&option.toString().toLowerCase().indexOf(null==e?void 0:e.toLowerCase())>=0}))},handleEnter:function(e){console.log(e),e&&(this.activeStep+=1)},readImage:function(e){console.log(e);var t=this;if(e.target.files&&e.target.files[0]){var n=new FileReader;n.onload=function(e){e.target.result&&t.shrinkImage(e.target.result).then((function(e){return t.stepItems.filter((function(e){return"Picture"==e.name}))[0].model='"'.concat(e,'"')}))},n.readAsDataURL(e.target.files[0])}},imageOverLimit:function(e){var t=e.length,n=5e4-t,o=0;return n<0&&(o=100*-n/t),{limit_exceeded:n<0,difference:n,biggerByPercent:o}},shrinkImage:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.group("shrinkImage"),o=t.imageOverLimit(e),console.log(o);case 3:if(!o.limit_exceeded){n.next=15;break}return console.group("shouldShrink by ".concat(o.biggerByPercent.toFixed(2),"%")),console.log("length difference: ".concat(o.difference)),n.next=8,t.resizeBase64Img(e,o.biggerByPercent);case 8:r=n.sent,e=r.base64URL,console.log("smallerImg: ".concat(r.resolution)),o=t.imageOverLimit(e),console.groupEnd(),n.next=3;break;case 15:return console.groupEnd(),n.abrupt("return",r.base64URL);case 17:case"end":return n.stop()}}),n)})))()},resizeBase64Img:function(e,t){return new Promise((function(n,o){var canvas=document.createElement("canvas"),r=canvas.getContext("2d"),img=document.createElement("img");img.src=e,img.onload=function(){var e=1-t/100;window.img=img;var o=parseInt(img.width*e),c=parseInt(img.height*e);canvas.style.width=o.toString()+"px",canvas.style.height=c.toString()+"px",canvas.width=o,canvas.height=c,r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.scale(e,e),r.drawImage(img,0,0);var l=document.querySelector("#image canvas");l?document.getElementById("image").replaceChild(canvas,l):document.getElementById("image").prepend(canvas),n({resolution:"".concat(o,"x").concat(c),base64URL:canvas.toDataURL()})}}))},checkRequired:function(){var e=this,t=["name","cat","subcat","challenge","pleasure","date"].filter((function(t){return!e.modelData[t]}));return!t.length||t},sendData:function(){this.feedback="",this.positive_feedback="";this.checkRequired();try{this.appendToSheetRequest()}catch(e){this.feedback=e}},addEmptyRowAndPasteData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"16uuM7tnvUeUNTM63sQD1NNZGMUUSRI2lVPQFG5oxdC8",n={insertDimension:{range:{sheetId:0,dimension:"ROWS",startIndex:1,endIndex:2},inheritFromBefore:!1}},o={pasteData:{delimiter:",",type:"PASTE_NORMAL",data:Object.values(e.modelData).join(","),coordinate:{columnIndex:0,rowIndex:1,sheetId:0}}},r={spreadsheetId:"16uuM7tnvUeUNTM63sQD1NNZGMUUSRI2lVPQFG5oxdC8",resource:{requests:[n,o]}},t.next=6,e.$gapi.getGapiClient();case 6:return c=t.sent,t.next=9,c.client.sheets.spreadsheets.batchUpdate(r).then((function(t){console.log(t),e.positive_feedback=t})).catch((function(t){e.feedback=t.result.error.message}));case 9:case"end":return t.stop()}}),t)})))()},appendToSheetRequest:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isAuthorized){t.next=5;break}return t.next=3,e.addEmptyRowAndPasteData();case 3:t.next=10;break;case 5:if(!e.GoogleAuth){t.next=10;break}return t.next=8,e.loginAttempt(e.GoogleAuth);case 8:t.sent?e.appendToSheetRequest():e.feedback="User needs to be signed in before making request to Google Sheets API";case 10:case"end":return t.stop()}}),t)})))()}}},v=(n(264),n(37)),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),n("div",{staticClass:"section"},[n("b-steps",{staticClass:"has-text-centered container",attrs:{animated:e.isAnimated,rounded:e.isRounded,"has-navigation":e.hasNavigation,"icon-prev":e.prevIcon,"icon-next":e.nextIcon,"label-position":e.labelPosition,"mobile-mode":e.mobileMode},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},e._l(e.stepItems,(function(t,o){return n("b-step-item",{key:o+t,attrs:{type:{"is-success":t.done},step:o+1,label:t.name,clickable:!0}},["autocomplete"==t.type?n("b-field",[n("b-autocomplete",{staticClass:"container",attrs:{rounded:"",data:e.filterOptions(t.model,e.autoCompleteData[o]),icon:"magnify",clearable:""},on:{select:function(t){return e.handleEnter(t)}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleEnter.apply(null,arguments)}},scopedSlots:e._u([{key:"empty",fn:function(){return[e._v(" No results found ")]},proxy:!0}],null,!0),model:{value:t.model,callback:function(n){e.$set(t,"model",n)},expression:"item.model"}})],1):"file"==t.type?n("div",{attrs:{id:"image"}},[n("input",{attrs:{type:t.type,accept:"image/*"},on:{change:e.readImage}})]):n("b-input",{attrs:{min:"0",max:"10",type:t.type},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleEnter.apply(null,arguments)}},model:{value:t.model,callback:function(n){e.$set(t,"model",n)},expression:"item.model"}})],1)})),1),e._v(" "),n("div",{staticClass:"mt-5 container has-text-centered"},[n("p",{staticClass:"feedback-text"},[e._v(e._s(e.feedback))]),e._v(" "),n("p",{staticClass:"feedback-text-positive"},[e._v(e._s(e.positive_feedback))]),e._v(" "),n("b-button",{attrs:{type:"is-success"},on:{click:e.sendData}},[e._v("SEND")])],1)],1)])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"hero is-primary is-medium"},[n("div",{staticClass:"hero-body container"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[e._v("Origami Sheet")]),e._v(" "),n("h1",{staticClass:"subtitle"},[e._v("A page for all your spreadsheet needs")])])])])}],!1,null,null,null);t.default=component.exports}}]);